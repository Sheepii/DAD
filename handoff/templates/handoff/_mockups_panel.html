{% load handoff_extras %}
<div id="mockups-panel">
  <h5 class="card-title">Mockups</h5>
  <div class="text-muted small mb-2">
    Click a mockup image or static slide to download it.
  </div>
  <div class="mb-3">
    <a
      class="btn btn-primary btn-sm me-2"
      href="{% url 'handoff:download_mockups' task.id %}"
    >
      Download ZIP
    </a>
  </div>
  <div class="row g-2">
    {% for card in mockup_cards %}
      <div class="col-6 col-md-4 col-lg-3">
        {% if card.kind == "slot" %}
          {% include "handoff/_mockup_slot.html" with slot=card.slot fallback_image_id=card.fallback_image_id required_orders=required_orders %}
        {% else %}
          {% with extra=card.extra %}
            <div class="border rounded p-2 h-100">
              {% if extra.is_video %}
                <video
                  controls
                  class="w-100 rounded mb-2"
                  style="background: #000; aspect-ratio: 1/1; object-fit: cover;"
                  preload="metadata"
                >
                  <source src="{% url 'handoff:mockup_file_download' extra.drive_file_id %}" />
                </video>
              {% else %}
                <a
                  href="{% url 'handoff:mockup_file_download' extra.drive_file_id %}"
                  download="{{ extra.filename }}"
                  class="d-block text-decoration-none"
                >
                  <img
                    src="https://drive.google.com/thumbnail?id={{ extra.drive_file_id }}&sz=w300"
                    alt="{{ extra.label }}"
                    class="img-fluid rounded mb-2"
                    style="background: #000; object-fit: cover; display: block;"
                    loading="lazy"
                  />
                </a>
              {% endif %}
              <div class="small fw-semibold">
                {{ extra.label }}
                <span class="badge bg-secondary ms-1">Static</span>
              </div>
              <div class="text-muted small">{{ extra.filename }}</div>
              {% if not extra.include_in_mockup_zip %}
                <div class="small">
                  <span class="badge bg-warning text-dark">Visible only</span>
                </div>
              {% endif %}
            </div>
          {% endwith %}
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>
